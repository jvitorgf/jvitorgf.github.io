<!DOCTYPE html>
<html>
<head>
	<title>Food search</title>
	<link rel="stylesheet" type="text/css" href="styles/estilos.css">
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@200&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

</head>
<body>
	<img class="img-resize" src="img/home-food.png">	
	<h1 class="title">Procure por algum alimento industrializado</h1>
	<input id="input-busca" class="input-resize" type="text" size="30" name="">
	<button id="botao-busca" class="button-resize" type="button">Buscar</button>
	
	
	<h2 id="vazio" class="title hide"><i class="fas fa-times"></i> Erro: o campo não pode ser vazio.</h2>
	<h2 id="qtdMin" class="title hide"><i class="fas fa-times"></i> Erro: o campo deve possuir pelo menos 3 caracteres.</h2>

	<div class="card">
		<img class="img-card-resize" src="https://static.openfoodfacts.org/images/products/301/762/042/2003/front_fr.248.400.jpg">
		<div class=card-nome>
			<strong>Nutella - 400 g</strong>
		
		</div>

		<div class="card-marca">
			Ferrero, Nutella
		</div>

		<div class="card-nutriscore">
			Nutri-Score: <strong>E</strong>
			<br>
						<br>
			
			<span class="text-nutri">
			Má qualidade nutricional		
			</span>
		
		</div>

		<div class="info-nutri">

			Em uma porção de 100g existem:	
		<br>
		<br>
		<span class="serving-nutri-facts">
		<strong>30.9</strong> g de gordura - <strong>10.6</strong> g de gordura saturada - <strong>56.3</strong> g de carboidratos - <strong>0.107</strong> g de sódio
			</span>
		</div>
	</div>

	<ul id="lista">
		
	</ul>

	<script type="text/javascript">
		var container = document.querySelector("#lista");
		document.querySelector("#botao-busca").addEventListener("click",validarInput);

		function validarInput(){
			document.querySelector("#vazio").classList.add("hide");
			document.querySelector("#qtdMin").classList.add("hide");
			var input = document.querySelector("#input-busca").value;

            container.innerHTML = "";

			if (input == ""){
				document.querySelector("#vazio").classList.remove("hide");
				return false;
			}else if (input.length < 3){
				document.querySelector("#qtdMin").classList.remove("hide");
				return false;
			}else{
				var query = document.querySelector("#input-busca").value;
				axios.get("https://world.openfoodfacts.org/cgi/search.pl?search_terms=" +
				query + "&search_simple=1&action=process&json=1").then
				(function(res){
					console.log(res);	
					let products = res.data.products;
					for(var i = 0; i <products.length && i< 10 ;i++){
						var li = document.createElement("li");
						var img = document.createElement("img");
						var img_url = products[i].image_url;


						li.innerHTML = products[i].product_name + " - " + products[i].quantity +
						" - " +products[i].nutriscore_grade +
						" - " +products[i].brands +
						" - " +products[i].nutriments.fat_100g +
						" - " + products[i].nutriments["saturated-fat_100g"] +
						" - " + products[i].nutriments.salt_100g +
						" - " + products[i].nutriments.sugars_100g ;

						img.src = img_url;
						li.appendChild(img);
						container.appendChild(li);
					}
				});
			}
		}

	</script>
</body>
</html>